use super::types::Manifest;

#[test]
fn test_serialize_v1() {
    let test_data = r#"{"product":{"timestamp":26564157,"depots":[{"languages":["Neutral"],"size":"1253528","gameIDs":["1207658924"],"systems":["Windows"],"manifest":"8fb0f61a-28c8-43fe-a63a-6538922e3086.json"},{"languages":["English"],"size":"14990294261","gameIDs":["1207658924"],"systems":["Windows"],"manifest":"893f7b7d-dbe9-404c-af0b-cfc383ba9ce9.json"},{"redist":"MSVC2005","executable":"__redist/MSVC2005/vcredist_x86.exe","argument":"/Q","size":"0"}],"support_commands":[{"languages":["Neutral"],"executable":"/galaxy_the_witcher_enhanced_edition_2.1.0.15.exe","gameID":"1207658924","argument":"","systems":["Windows"]}],"installDirectory":"The Witcher Enhanced Edition","rootGameID":"1207658924","gameIDs":[{"gameID":"1207658924","name":{"en":"The Witcher Enhanced Edition Director's Cut"},"dependencies":[],"standalone":true}],"projectName":"The Witcher Enhanced Edition Director's Cut"},"version":1}"#;
    let manifest = serde_json::from_str::<Manifest>(test_data).expect("Serialize failed");

    if let Manifest::V2(_) = manifest {
        panic!("V2 type");
    }
}

#[test]
fn test_serialize_v2() {
    let test_data = r#"{"baseProductId":"1998527297","buildId":"56699004712175290","clientId":"56458061335487272","clientSecret":"2bc9d0c9ce0cf19b2fcf8735991bd1a3c6f739a5af5f41eb8a2f5edee32f27d6","dependencies":["DirectX","MSVC2012","MSVC2019"],"depots":[{"compressedSize":26958385540,"languages":["*"],"manifest":"0684aed98aaaaeaf9c9dc49ea2577783","osBitness":["64"],"productId":"1998527297","size":28310418094},{"compressedSize":3100402653,"languages":["ru-RU","pl-PL","it-IT","en-US","es-ES","de-DE","fr-FR","pt-BR"],"manifest":"92c9da65cf34c0e5cd12511c5d81954d","osBitness":["64"],"productId":"1998527297","size":4289033078},{"compressedSize":4368116881,"languages":["en-US"],"manifest":"2b94fe873ec1d378cf01e1e2464e89c8","osBitness":["64"],"productId":"1998527297","size":4825480363},{"compressedSize":4252207427,"languages":["fr-FR"],"manifest":"819fe8f1440710bed7aaaf5d85c34bac","osBitness":["64"],"productId":"1998527297","size":4688609724},{"compressedSize":4447198690,"languages":["de-DE"],"manifest":"72c871ff9cf4ea8c5bd3f2ea4d392429","osBitness":["64"],"productId":"1998527297","size":4898602080},{"compressedSize":4418420176,"languages":["it-IT"],"manifest":"db2091a59d95b3f9324597bdf4c28c59","osBitness":["64"],"productId":"1998527297","size":4855246172},{"compressedSize":4358531605,"languages":["pl-PL"],"manifest":"326b8b8ff2d2555911779599e81191f1","osBitness":["64"],"productId":"1998527297","size":4836862873},{"compressedSize":4358459159,"languages":["ru-RU"],"manifest":"d41ec61fdc60e550aed468b8f8c17b4c","osBitness":["64"],"productId":"1998527297","size":4836823129},{"compressedSize":4446878526,"languages":["es-ES"],"manifest":"b74a8e40ac9be6842d133afffe3ddf32","osBitness":["64"],"productId":"1998527297","size":4900194370},{"compressedSize":4358430181,"languages":["pt-BR"],"manifest":"85ebbd911835881324cd538adf85f5ac","osBitness":["64"],"productId":"1998527297","size":4836735439},{"compressedSize":550,"isGogDepot":true,"languages":["fr-FR"],"manifest":"b1f562c797e26b93adef4d29b1db2952","osBitness":["64"],"productId":"1998527297","size":582},{"compressedSize":381,"isGogDepot":true,"languages":["fr-FR"],"manifest":"4b89502774e643873af69d49994fa8f9","osBitness":["64"],"productId":"1998527297","size":1345},{"compressedSize":559,"isGogDepot":true,"languages":["pt-BR"],"manifest":"a8863df75afd308d183bdba5e29fdfbd","osBitness":["64"],"productId":"1998527297","size":593},{"compressedSize":396,"isGogDepot":true,"languages":["pt-BR"],"manifest":"0666cfadd478483badcabdb76d3da2a9","osBitness":["64"],"productId":"1998527297","size":1361},{"compressedSize":558,"isGogDepot":true,"languages":["pl-PL"],"manifest":"62a751fcea147605623318591a886a02","osBitness":["64"],"productId":"1998527297","size":590},{"compressedSize":382,"isGogDepot":true,"languages":["pl-PL"],"manifest":"211a18b8d72570cb1a6a56a02535854e","osBitness":["64"],"productId":"1998527297","size":1345},{"compressedSize":546,"isGogDepot":true,"languages":["es-ES"],"manifest":"a28d8c05f983ee4661261ed52f83513e","osBitness":["64"],"productId":"1998527297","size":579},{"compressedSize":382,"isGogDepot":true,"languages":["es-ES"],"manifest":"49ba63da449d61275f31e8f45b482b40","osBitness":["64"],"productId":"1998527297","size":1346},{"compressedSize":545,"isGogDepot":true,"languages":["en-US"],"manifest":"093332510c974cd3ab968ffa3a277f26","osBitness":["64"],"productId":"1998527297","size":579},{"compressedSize":383,"isGogDepot":true,"languages":["en-US"],"manifest":"587722a2296b44d8ac239cdb5143fe23","osBitness":["64"],"productId":"1998527297","size":1346},{"compressedSize":546,"isGogDepot":true,"languages":["de-DE"],"manifest":"ebe007c1a150a28e8abef4fc673a19fd","osBitness":["64"],"productId":"1998527297","size":581},{"compressedSize":381,"isGogDepot":true,"languages":["de-DE"],"manifest":"10fed678734e4550c9d692a9215f9279","osBitness":["64"],"productId":"1998527297","size":1345},{"compressedSize":555,"isGogDepot":true,"languages":["ru-RU"],"manifest":"c6dae226aacbbcbfc7c4963b03e3162a","osBitness":["64"],"productId":"1998527297","size":589},{"compressedSize":382,"isGogDepot":true,"languages":["ru-RU"],"manifest":"73502db96ea65b7e28f29450dc7cfe9c","osBitness":["64"],"productId":"1998527297","size":1346},{"compressedSize":549,"isGogDepot":true,"languages":["it-IT"],"manifest":"f57b856b8b1142181c0d21ea5b3b4da0","osBitness":["64"],"productId":"1998527297","size":580},{"compressedSize":382,"isGogDepot":true,"languages":["it-IT"],"manifest":"89b4f50a9bb8143959667ce313dd8601","osBitness":["64"],"productId":"1998527297","size":1346},{"compressedSize":401,"isGogDepot":true,"languages":["*"],"manifest":"4b6d4e44f497a752aad9bccc00ec2d96","osBitness":["64"],"productId":"1998527297","size":2004},{"compressedSize":62501047906,"languages":["*"],"manifest":"ffb5c3f7cc5964498161f91a26841bc5","osBitness":["64"],"productId":"1408237434","size":62603198551},{"compressedSize":651,"isGogDepot":true,"languages":["*"],"manifest":"fb25d6b744008854ce90708c1aa62b88","osBitness":["64"],"productId":"1408237434","size":693},{"compressedSize":209,"isGogDepot":true,"languages":["*"],"manifest":"dbc0ba4982626af5221e3f15dca92798","osBitness":["64"],"productId":"1408237434","size":334}],"installDirectory":"Fallout 4 GOTY","offlineDepot":{"compressedSize":1103,"languages":["*"],"manifest":"a6718047e07591b71ecd0e8e344a45d3","productId":"1998527297","size":5152},"platform":"windows","products":[{"name":"Fallout 4: Game of the Year Edition","productId":"1998527297","temp_arguments":"","temp_executable":""},{"name":"Fallout 4 - High Resolution Texture Pack","productId":"1408237434","temp_arguments":"","temp_executable":""}],"scriptInterpreter":true,"tags":["csb_10_6_1_w_158","galaxy"],"version":2}"#;
    let manifest = serde_json::from_str::<Manifest>(test_data).expect("Serialize failed");

    if let Manifest::V1(_) = manifest {
        panic!("V1 type");
    }
}
